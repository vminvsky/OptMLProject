/scratch/venia/python/miniconda3/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                           | 0/940 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 10%|###########################4                                                                                                                                                                                                                                                      | 94/940 [00:40<06:10,  2.28it/s]
 21%|#########################################################5                                                                                                                                                                                                                          | 5/24 [00:00<00:03,  5.70it/s]


 62%|###########################################################################################################################################################################8                                                                                                       | 15/24 [00:02<00:01,  5.08it/s]
 10%|###########################4                                                                                                                                                                                                                                                      | 94/940 [00:45<06:10,  2.28it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 20%|######################################################6                                                                                                                                                                                                                          | 188/940 [01:31<05:18,  2.36it/s]
  8%|#######################                                                                                                                                                                                                                                                             | 2/24 [00:00<00:02,  9.93it/s]



  warnings.warn('Was asked to gather along dimension 0, but all '
{'eval_loss': 0.9852616875182226, 'eval_f1': 0.31818181818181823, 'eval_roc_auc': 0.5147035077554354, 'eval_accuracy': 0.328, 'eval_runtime': 4.6583, 'eval_samples_per_second': 161.003, 'eval_steps_per_second': 5.152, 'epoch': 2.0}



















 30%|#################################################################################8                                                                                                                                                                                               | 282/940 [02:19<04:23,  2.50it/s]
  0%|                                                                                                                                                                                                                                                                                            | 0/24 [00:00<?, ?it/s]



 88%|################################################################################################################################################################################################################################################6                                  | 21/24 [00:03<00:00,  4.89it/s]
 30%|#################################################################################8                                                                                                                                                                                               | 282/940 [02:24<04:23,  2.50it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




















 40%|#############################################################################################################2                                                                                                                                                                   | 376/940 [03:08<04:00,  2.35it/s]
 33%|############################################################################################                                                                                                                                                                                        | 8/24 [00:01<00:03,  5.32it/s]


 79%|#########################################################################################################################################################################################################################7                                                         | 19/24 [00:03<00:00,  5.19it/s]
 40%|#############################################################################################################2                                                                                                                                                                   | 376/940 [03:13<04:00,  2.35it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




















 50%|########################################################################################################################################5                                                                                                                                        | 470/940 [03:57<03:34,  2.19it/s]
 25%|#####################################################################                                                                                                                                                                                                               | 6/24 [00:00<00:03,  5.74it/s]


 58%|################################################################################################################################################################4                                                                                                                  | 14/24 [00:02<00:02,  4.83it/s]
 50%|########################################################################################################################################5                                                                                                                                        | 470/940 [04:02<03:34,  2.19it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 60%|###################################################################################################################################################################7                                                                                                             | 564/940 [04:45<02:22,  2.63it/s]
 17%|##############################################                                                                                                                                                                                                                                      | 4/24 [00:00<00:02,  7.10it/s]


 58%|################################################################################################################################################################4                                                                                                                  | 14/24 [00:02<00:02,  4.61it/s]
 60%|###################################################################################################################################################################7                                                                                                             | 564/940 [04:50<02:22,  2.63it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 70%|###############################################################################################################################################################################################1                                                                                 | 658/940 [05:34<02:01,  2.33it/s]
  8%|#######################                                                                                                                                                                                                                                                             | 2/24 [00:00<00:02, 10.32it/s]



 92%|############################################################################################################################################################################################################################################################                       | 22/24 [00:04<00:00,  4.88it/s]
 70%|###############################################################################################################################################################################################1                                                                                 | 658/940 [05:39<02:01,  2.33it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 80%|#########################################################################################################################################################################################################################2                                                       | 748/940 [06:21<01:23,  2.30it/s]
 80%|##########################################################################################################################################################################################################################4                                                      | 752/940 [06:22<01:18,  2.39it/s]


 92%|############################################################################################################################################################################################################################################################                       | 22/24 [00:04<00:00,  5.46it/s]

 80%|##########################################################################################################################################################################################################################4                                                      | 752/940 [06:27<01:18,  2.39it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




















 90%|#####################################################################################################################################################################################################################################################7                           | 846/940 [07:11<00:39,  2.39it/s]
{'loss': 0.6871, 'learning_rate': 2.0000000000000003e-06, 'epoch': 9.0}

 83%|#####################################################################################################################################################################################################################################1                                             | 20/24 [00:03<00:00,  5.13it/s]

 90%|#####################################################################################################################################################################################################################################################7                           | 846/940 [07:15<00:39,  2.39it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '



















 99%|###############################################################################################################################################################################################################################################################################5 | 935/940 [07:57<00:02,  2.37it/s]
100%|#################################################################################################################################################################################################################################################################################| 940/940 [07:59<00:00,  2.46it/s]


 92%|############################################################################################################################################################################################################################################################                       | 22/24 [00:04<00:00,  4.92it/s]

{'eval_loss': 0.8492616875182226, 'eval_f1': 0.45307511464561445, 'eval_roc_auc': 0.5325129890483563, 'eval_accuracy': 0.464, 'eval_runtime': 4.655, 'eval_samples_per_second': 161.117, 'eval_steps_per_second': 5.156, 'epoch': 10.0}
100%|#################################################################################################################################################################################################################################################################################| 940/940 [08:06<00:00,  1.93it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  5.25it/s]
100%|###################################################################################################################################################################################################################################################################################| 24/24 [00:04<00:00,  5.35it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|###################################################################################################################################################################################################################################################################################| 14/14 [00:02<00:00,  5.83it/s]
/scratch/venia/socialgpt/venia_worker_vs_gpt/src/finetuning/trainers.py:195: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = softmax(torch.Tensor(y_pred_logits)).numpy()