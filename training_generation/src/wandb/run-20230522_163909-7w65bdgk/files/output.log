/scratch/venia/python/miniconda3/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                          | 0/1410 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 10%|###########################2                                                                                                                                                                                                                                                    | 141/1410 [01:09<09:22,  2.25it/s]
{'loss': 0.6919, 'learning_rate': 1.8e-05, 'epoch': 1.0}

 83%|#####################################################################################################################################################################################################################################1                                             | 20/24 [00:03<00:00,  4.94it/s]

 10%|###########################2                                                                                                                                                                                                                                                    | 141/1410 [01:14<09:22,  2.25it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

































 20%|######################################################4                                                                                                                                                                                                                         | 282/1410 [02:25<09:06,  2.07it/s]
 38%|#######################################################################################################5                                                                                                                                                                            | 9/24 [00:01<00:02,  5.17it/s]


 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  5.29it/s]
 20%|######################################################4                                                                                                                                                                                                                         | 282/1410 [02:30<09:06,  2.07it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 30%|#################################################################################6                                                                                                                                                                                              | 423/1410 [03:42<07:55,  2.07it/s]
 29%|################################################################################5                                                                                                                                                                                                   | 7/24 [00:01<00:03,  5.17it/s]


 71%|##################################################################################################################################################################################################7                                                                                | 17/24 [00:03<00:01,  5.23it/s]
 30%|#################################################################################6                                                                                                                                                                                              | 423/1410 [03:46<07:55,  2.07it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 40%|############################################################################################################8                                                                                                                                                                   | 564/1410 [04:58<06:36,  2.13it/s]
 33%|############################################################################################                                                                                                                                                                                        | 8/24 [00:01<00:03,  5.13it/s]


 79%|#########################################################################################################################################################################################################################7                                                         | 19/24 [00:03<00:00,  5.27it/s]
 40%|############################################################################################################8                                                                                                                                                                   | 564/1410 [05:03<06:36,  2.13it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 50%|########################################################################################################################################                                                                                                                                        | 705/1410 [06:14<05:37,  2.09it/s]
 33%|############################################################################################                                                                                                                                                                                        | 8/24 [00:01<00:02,  5.46it/s]


 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  5.04it/s]
 50%|########################################################################################################################################                                                                                                                                        | 705/1410 [06:18<05:37,  2.09it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
































 60%|##################################################################################################################################################################8                                                                                                             | 844/1410 [07:30<04:29,  2.10it/s]
 60%|###################################################################################################################################################################2                                                                                                            | 846/1410 [07:31<04:31,  2.08it/s]


 67%|#######################################################################################################################################################################################3                                                                                           | 16/24 [00:03<00:01,  4.77it/s]
 60%|###################################################################################################################################################################2                                                                                                            | 846/1410 [07:36<04:31,  2.08it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 70%|##############################################################################################################################################################################################2                                                                                 | 986/1410 [08:46<03:24,  2.08it/s]
 70%|##############################################################################################################################################################################################3                                                                                 | 987/1410 [08:47<03:19,  2.12it/s]

 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  4.97it/s]

 70%|##############################################################################################################################################################################################3                                                                                 | 987/1410 [08:52<03:19,  2.12it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 80%|########################################################################################################################################################################################################################4                                                      | 1126/1410 [10:02<02:35,  1.83it/s]
 80%|########################################################################################################################################################################################################################8                                                      | 1128/1410 [10:03<02:21,  1.99it/s]


 67%|#######################################################################################################################################################################################3                                                                                           | 16/24 [00:02<00:01,  5.26it/s]
 80%|########################################################################################################################################################################################################################8                                                      | 1128/1410 [10:08<02:21,  1.99it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































 90%|###################################################################################################################################################################################################################################################5                           | 1267/1410 [11:19<01:08,  2.09it/s]
 90%|###################################################################################################################################################################################################################################################9                           | 1269/1410 [11:20<01:08,  2.06it/s]


 62%|###########################################################################################################################################################################8                                                                                                       | 15/24 [00:02<00:01,  5.04it/s]
 90%|###################################################################################################################################################################################################################################################9                           | 1269/1410 [11:25<01:08,  2.06it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


































100%|###############################################################################################################################################################################################################################################################################| 1410/1410 [12:36<00:00,  2.01it/s]
 12%|##################################5                                                                                                                                                                                                                                                 | 3/24 [00:00<00:03,  6.44it/s]


 96%|#######################################################################################################################################################################################################################################################################5           | 23/24 [00:04<00:00,  5.40it/s]

{'eval_loss': 0.9159283541848894, 'eval_f1': 0.397226173541963, 'eval_roc_auc': 0.5231380780957627, 'eval_accuracy': 0.3973333333333333, 'eval_runtime': 4.774, 'eval_samples_per_second': 157.102, 'eval_steps_per_second': 5.027, 'epoch': 10.0}
100%|###############################################################################################################################################################################################################################################################################| 1410/1410 [12:43<00:00,  1.85it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

100%|###################################################################################################################################################################################################################################################################################| 24/24 [00:04<00:00,  5.31it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
 36%|##################################################################################################5                                                                                                                                                                                 | 5/14 [00:00<00:01,  5.73it/s]
100%|###################################################################################################################################################################################################################################################################################| 14/14 [00:02<00:00,  5.76it/s]
/scratch/venia/socialgpt/venia_worker_vs_gpt/src/finetuning/trainers.py:195: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = softmax(torch.Tensor(y_pred_logits)).numpy()