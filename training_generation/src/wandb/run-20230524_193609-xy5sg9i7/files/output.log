/scratch/venia/python/miniconda3/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                          | 0/4000 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '













































 10%|###########################2                                                                                                                                                                                                                                                    | 400/4000 [01:33<14:24,  4.17it/s]
  4%|###########7                                                                                                                                                                                                                                                                       | 8/188 [00:00<00:16, 10.66it/s]









 96%|######################################################################################################################################################################################################################################################################8          | 181/188 [00:16<00:00, 10.69it/s]
 10%|###########################2                                                                                                                                                                                                                                                    | 400/4000 [01:50<14:24,  4.17it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '















































 20%|######################################################3                                                                                                                                                                                                                         | 799/4000 [03:28<11:41,  4.56it/s]
 20%|######################################################4                                                                                                                                                                                                                         | 800/4000 [03:28<11:37,  4.59it/s]








 90%|#####################################################################################################################################################################################################################################################4                           | 169/188 [00:15<00:01, 10.33it/s]
 20%|######################################################4                                                                                                                                                                                                                         | 800/4000 [03:45<11:37,  4.59it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '













































 30%|#################################################################################3                                                                                                                                                                                             | 1200/4000 [05:22<10:40,  4.37it/s]
  7%|##################9                                                                                                                                                                                                                                                               | 13/188 [00:00<00:13, 12.61it/s]








 98%|############################################################################################################################################################################################################################################################################6    | 185/188 [00:17<00:00, 10.20it/s]

 30%|#################################################################################3                                                                                                                                                                                             | 1200/4000 [05:40<10:40,  4.37it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '















































 40%|############################################################################################################4                                                                                                                                                                  | 1600/4000 [07:19<08:58,  4.46it/s]
  8%|#####################8                                                                                                                                                                                                                                                            | 15/188 [00:01<00:15, 10.98it/s]








 87%|##############################################################################################################################################################################################################################################1                                  | 164/188 [00:14<00:02, 11.98it/s]
 40%|############################################################################################################4                                                                                                                                                                  | 1600/4000 [07:36<08:58,  4.46it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '














































 50%|#######################################################################################################################################5                                                                                                                                       | 2000/4000 [09:13<07:23,  4.51it/s]
  6%|################                                                                                                                                                                                                                                                                  | 11/188 [00:00<00:16, 10.57it/s]








 89%|###################################################################################################################################################################################################################################################9                             | 168/188 [00:15<00:01, 10.91it/s]
 50%|#######################################################################################################################################5                                                                                                                                       | 2000/4000 [09:30<07:23,  4.51it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '















































 60%|##################################################################################################################################################################5                                                                                                            | 2399/4000 [11:09<06:35,  4.05it/s]
 60%|##################################################################################################################################################################6                                                                                                            | 2400/4000 [11:10<06:24,  4.16it/s]








 99%|##############################################################################################################################################################################################################################################################################   | 186/188 [00:17<00:00, 11.26it/s]

 60%|##################################################################################################################################################################6                                                                                                            | 2400/4000 [11:27<06:24,  4.16it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '














































 70%|#############################################################################################################################################################################################4                                                                                 | 2796/4000 [13:03<04:37,  4.34it/s]
 70%|#############################################################################################################################################################################################7                                                                                 | 2800/4000 [13:04<04:36,  4.33it/s]








 98%|############################################################################################################################################################################################################################################################################6    | 185/188 [00:17<00:00, 10.47it/s]

 70%|#############################################################################################################################################################################################7                                                                                 | 2800/4000 [13:22<04:36,  4.33it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '














































 80%|########################################################################################################################################################################################################################6                                                      | 3198/4000 [14:58<03:10,  4.21it/s]
 80%|########################################################################################################################################################################################################################8                                                      | 3200/4000 [14:59<02:59,  4.44it/s]






 99%|###############################################################################################################################################################################################################################################################################5 | 187/188 [00:17<00:00, 11.68it/s]

 80%|########################################################################################################################################################################################################################8                                                      | 3200/4000 [15:16<02:59,  4.44it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '














































 90%|###################################################################################################################################################################################################################################################9                           | 3600/4000 [16:52<01:37,  4.08it/s]
{'loss': 0.016, 'learning_rate': 2.0000000000000003e-06, 'epoch': 9.0}








 91%|########################################################################################################################################################################################################################################################3                        | 171/188 [00:15<00:01, 10.29it/s]
 90%|###################################################################################################################################################################################################################################################9                           | 3600/4000 [17:09<01:37,  4.08it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '















































100%|##############################################################################################################################################################################################################################################################################6| 3995/4000 [18:46<00:01,  3.94it/s]
100%|###############################################################################################################################################################################################################################################################################| 4000/4000 [18:47<00:00,  4.06it/s]








 88%|###############################################################################################################################################################################################################################################6                                 | 165/188 [00:14<00:02, 10.94it/s]
{'eval_loss': 0.5567780472653845, 'eval_f1': 0.9945708495274953, 'eval_roc_auc': 0.9994588414350835, 'eval_accuracy': 0.9946666666666667, 'eval_runtime': 17.0495, 'eval_samples_per_second': 43.99, 'eval_steps_per_second': 11.027, 'epoch': 10.0}
100%|###############################################################################################################################################################################################################################################################################| 4000/4000 [19:07<00:00,  3.49it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '








 98%|###########################################################################################################################################################################################################################################################################1     | 184/188 [00:17<00:00, 11.13it/s]
100%|#################################################################################################################################################################################################################################################################################| 188/188 [00:17<00:00, 10.81it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '














100%|#################################################################################################################################################################################################################################################################################| 350/350 [00:31<00:00, 11.01it/s]
/scratch/venia/socialgpt/venia_worker_vs_gpt/src/finetuning/trainers.py:195: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = softmax(torch.Tensor(y_pred_logits)).numpy()