/scratch/venia/python/miniconda3/lib/python3.10/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                          | 0/1250 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





























 10%|###########################2                                                                                                                                                                                                                                                    | 125/1250 [01:00<08:38,  2.17it/s]
 25%|#####################################################################                                                                                                                                                                                                               | 6/24 [00:00<00:03,  5.84it/s]


 67%|#######################################################################################################################################################################################3                                                                                           | 16/24 [00:03<00:01,  4.93it/s]
 10%|###########################2                                                                                                                                                                                                                                                    | 125/1250 [01:05<08:38,  2.17it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '






























 20%|######################################################4                                                                                                                                                                                                                         | 250/1250 [02:08<08:14,  2.02it/s]
 33%|############################################################################################                                                                                                                                                                                        | 8/24 [00:01<00:02,  5.54it/s]


 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  4.51it/s]
 20%|######################################################4                                                                                                                                                                                                                         | 250/1250 [02:13<08:14,  2.02it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





























 30%|#################################################################################6                                                                                                                                                                                              | 375/1250 [03:16<07:27,  1.95it/s]
 33%|############################################################################################                                                                                                                                                                                        | 8/24 [00:01<00:02,  5.58it/s]


 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  5.31it/s]
 30%|#################################################################################6                                                                                                                                                                                              | 375/1250 [03:21<07:27,  1.95it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '






























 40%|############################################################################################################8                                                                                                                                                                   | 500/1250 [04:24<06:21,  1.97it/s]
{'loss': 0.6779, 'learning_rate': 1.2e-05, 'epoch': 4.0}


 83%|#####################################################################################################################################################################################################################################1                                             | 20/24 [00:03<00:00,  4.97it/s]
 40%|############################################################################################################8                                                                                                                                                                   | 500/1250 [04:29<06:21,  1.97it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '






























 50%|#######################################################################################################################################7                                                                                                                                        | 624/1250 [05:32<05:10,  2.02it/s]
 50%|########################################################################################################################################                                                                                                                                        | 625/1250 [05:33<04:53,  2.13it/s]


 75%|##############################################################################################################################################################################################################2                                                                    | 18/24 [00:03<00:01,  5.11it/s]
 50%|########################################################################################################################################                                                                                                                                        | 625/1250 [05:37<04:53,  2.13it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





























 60%|##################################################################################################################################################################3                                                                                                             | 746/1250 [06:39<04:16,  1.96it/s]

 60%|###################################################################################################################################################################2                                                                                                            | 750/1250 [06:41<04:15,  1.96it/s]

 88%|################################################################################################################################################################################################################################################6                                  | 21/24 [00:03<00:00,  5.36it/s]

 60%|###################################################################################################################################################################2                                                                                                            | 750/1250 [06:45<04:15,  1.96it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





























 70%|#############################################################################################################################################################################################7                                                                                  | 872/1250 [07:46<03:19,  1.90it/s]
 70%|##############################################################################################################################################################################################3                                                                                 | 875/1250 [07:48<03:18,  1.89it/s]

 54%|####################################################################################################################################################9                                                                                                                              | 13/24 [00:02<00:02,  5.00it/s]


 70%|##############################################################################################################################################################################################3                                                                                 | 875/1250 [07:53<03:18,  1.89it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




























 80%|########################################################################################################################################################################################################################8                                                      | 1000/1250 [08:57<02:00,  2.08it/s]
 21%|#########################################################5                                                                                                                                                                                                                          | 5/24 [00:00<00:03,  5.80it/s]


 96%|#######################################################################################################################################################################################################################################################################5           | 23/24 [00:04<00:00,  5.25it/s]

 80%|########################################################################################################################################################################################################################8                                                      | 1000/1250 [09:02<02:00,  2.08it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '





























 90%|###################################################################################################################################################################################################################################################4                           | 1123/1250 [10:04<00:56,  2.23it/s]
 90%|###################################################################################################################################################################################################################################################9                           | 1125/1250 [10:05<00:55,  2.23it/s]


 71%|##################################################################################################################################################################################################7                                                                                | 17/24 [00:03<00:01,  4.92it/s]
 90%|###################################################################################################################################################################################################################################################9                           | 1125/1250 [10:09<00:55,  2.23it/s]/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '






























100%|###############################################################################################################################################################################################################################################################################| 1250/1250 [11:14<00:00,  1.96it/s]
  0%|                                                                                                                                                                                                                                                                                            | 0/24 [00:00<?, ?it/s]


 88%|################################################################################################################################################################################################################################################6                                  | 21/24 [00:04<00:00,  4.96it/s]

{'eval_loss': 0.9359283541848893, 'eval_f1': 0.3771462003695333, 'eval_roc_auc': 0.5084440687303502, 'eval_accuracy': 0.37733333333333335, 'eval_runtime': 4.7959, 'eval_samples_per_second': 156.383, 'eval_steps_per_second': 5.004, 'epoch': 10.0}
100%|###############################################################################################################################################################################################################################################################################| 1250/1250 [11:21<00:00,  1.83it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

100%|###################################################################################################################################################################################################################################################################################| 24/24 [00:04<00:00,  5.38it/s]
/scratch/venia/python/miniconda3/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|                                                                                                                                                                                                                                                                                            | 0/14 [00:00<?, ?it/s]

100%|###################################################################################################################################################################################################################################################################################| 14/14 [00:02<00:00,  5.69it/s]
/scratch/venia/socialgpt/venia_worker_vs_gpt/src/finetuning/trainers.py:195: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = softmax(torch.Tensor(y_pred_logits)).numpy()